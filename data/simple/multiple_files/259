three dimensional plot showing the values of the harmonic mean between two numbers in mathematics the harmonic mean sometimes called the subcontrary mean is one of several kinds of average typically it is appropriate for situations when the average of rates is desired it is the special case m 1 of the power mean as it tends strongly toward the least elements of the list it may compared to the arithmetic mean mitigate the influence of large outliers and increase the influence of small values contents 1 definition 1 1 discrete distribution 1 2 continuous distribution 1 3 weighted harmonic mean 1 4 recursive calculation 2 harmonic mean of two numbers 3 relationship with other means 4 inequalities 5 examples 5 1 geometry 5 2 trigonometry 5 3 algebra 5 4 physics 5 5 other sciences 5 6 finance 6 statistics 6 1 theoretical value 6 2 delta method 6 3 jackknife method 6 4 size biased sampling 6 5 shifted variables 6 6 moments 7 lognormal distribution 7 1 sampling properties 7 2 bias and variance estimators 8 pareto distribution 9 beta distribution 10 notes 11 see also 12 references 13 external links edit definition edit discrete distribution the harmonic mean h of the positive real numbers x 1 x 2 x n is defined to be the reciprocal of the arithmetic mean of the reciprocals of x 1 x 2 x n example the harmonic mean of 1 2 and 4 is edit continuous distribution for a continuous distribution the harmonic mean is edit weighted harmonic mean if a set of weights is associated with the dataset the weighted harmonic mean is defined by the harmonic mean is a special case where all of the weights are equal to 1 it is also equivalent to any weighted harmonic mean where all weights are equal edit recursive calculation it is possible to recursively calculate the harmonic mean h of n variates this method may be of use in computations edit harmonic mean of two numbers for the special case of just two numbers and the harmonic mean can be written in this special case the harmonic mean is related to the arithmetic mean and the geometric mean by so meaning the two numbers geometric mean equals the geometric mean of their arithmetic and harmonic means as noted above this relationship between the three pythagorean means is not limited to n equals 1 or 2 there is a relationship for all n however for n 1 all means are equal and for n 2 we have the above relationship between the means for arbitrary n 2 we may generalize this formula as noted above by interpreting the third equation for the harmonic mean differently the generalized relationship was already explained above if one carefully observes the third equation one will notice it also works for n 1 that is it predicts the equivalence between the harmonic and geometric means but it falls short by not predicting the equivalence between the harmonic and arithmetic means the general formula which can be derived from the third formula for the harmonic mean by the reinterpretation as explained in relationship with other means is notice that for n 2 we have where we used the fact that the arithmetic mean evaluates to the same number independent of the order of the terms this equation can be reduced to the original equation if we reinterpret this result in terms of the operators themselves if we do this we get the symbolic equation because each function was evaluated at edit relationship with other means a geometric construction of the three pythagorean means of two numbers a and b harmonic mean is denoted by h in purple color the q denotes a fourth mean the quadratic mean if a set of non identical numbers is subjected to a mean preserving spread that is two or more elements of the set are spread apart from each other while leaving the arithmetic mean unchanged then the harmonic mean always decreases 1 let r be a non zero real number and let the r th power mean m r of a series of real variables a 1 a 2 a 3 be defined as for r 1 1 and 2 we have the harmonic the arithmetic and the quadratic means respectively define r 0 and to be the geometric mean the minimum of the variates and the maximum of the variates respectively then for any two real numbers s and t such that s lt t we have with equality only if all the a i are equal let r be the quadratic mean or root mean square then 2 edit inequalities for a set of positive real variables lying within the interval m m it has been shown that where a is the arithmetic mean h is the harmonic mean m is the maximum of the interval and s 2 is the variance of the set 3 several other inequalities are also known 4 edit examples edit geometry in any triangle the radius of the incircle is one third the harmonic mean of the altitudes for any point p on the minor arc bc of the circumcircle of an equilateral triangle abc with distances q and t from b and c respectively and with the intersection of pa and bc being at a distance y from point p we have that y is half the harmonic mean of q and t 5 in a right triangle with legs a and b and altitude h from the hypotenuse to the right angle h 2 is half the harmonic mean of a 2 and b 2 6 7 let t and s t gt s be the sides of the two inscribed squares in a right triangle with hypotenuse c then s 2 equals half the harmonic mean of c 2 and t 2 let a trapezoid have vertices a b c and d in sequence and have parallel sides ab and cd let e be the intersection of the diagonals and let f be on side da and g be on side bc such that feg is parallel to ab and cd then fg is the harmonic mean of ab and dc this is provable using similar triangles crossed ladders h is half the harmonic mean of a and b in the crossed ladders problem two ladders lie oppositely across an alley each with feet at the base of one sidewall with one leaning against a wall at height a and the other leaning against the opposite wall at height b as shown the ladders cross at a height of h above the alley floor then h is half the harmonic mean of a and b this result still holds if the walls are slanted but still parallel and the heights a b and h are measured as distances from the floor along lines parallel to the walls in an ellipse the semi latus rectum the distance from a focus to the ellipse along a line parallel to the minor axis is the harmonic mean of the maximum and minimum distances of the ellipse from a focus edit trigonometry in the case of the double angle tangent identity if the tangent of an angle a is given as a b then the tangent of 2 a is the product of 1 the harmonic mean of the numerator and denominator of tan a and 2 the reciprocal of the denominator less the numerator of tan a in symbols if a and b are real numbers and the double angle formula for the tangent can be written as where h a b is the harmonic mean of a and b example let the harmonic mean of 3 and 7 is the most familiar form of the double angle formula is the double angle formula can also be written as edit algebra the harmonic mean also features in elementary algebra when considering problems of working in parallel example if a gas powered pump can drain a pool in 4 hours and a battery powered pump can drain the same pool in 6 hours then it will take both pumps hours to drain the pool working together edit physics in certain situations especially many situations involving rates and ratios the harmonic mean provides the truest average for instance if a vehicle travels a certain distance at a speed x e g 60 kilometres per hour and then the same distance again at a speed y e g 40 kilometres per hour then its average speed is the harmonic mean of x and y 48 kilometres per hour and its total travel time is the same as if it had traveled the whole distance at that average speed however if the vehicle travels for a certain amount of time at a speed x and then the same amount of time at a speed y then its average speed is the arithmetic mean of x and y which in the above example is 50 kilometres per hour the same principle applies to more than two segments given a series of sub trips at different speeds if each sub trip covers the same distance then the average speed is the harmonic mean of all the sub trip speeds and if each sub trip takes the same amount of time then the average speed is the arithmetic mean of all the sub trip speeds if neither is the case then a weighted harmonic mean or weighted arithmetic mean is needed similarly if one connects two electrical resistors in parallel one having resistance x e g 60 and one having resistance y e g 40 then the effect is the same as if one had used two resistors with the same resistance both equal to the harmonic mean of x and y 48 the equivalent resistance in either case is 24 one half of the harmonic mean however if one connects the resistors in series then the average resistance is the arithmetic mean of x and y with total resistance equal to the sum of x and y and as with previous example the same principle applies when more than two resistors are connected provided that all are in parallel or all are in series the weighted harmonic mean is the correct approach to determine the average specific gravity of a mixture when the composition by weight is known note however that this is only correct for ideal solutions edit other sciences in computer science specifically information retrieval and machine learning the harmonic mean of the precision and the recall is often used as an aggregated performance score for the evaluation of algorithms and systems the f score or f measure in hydrology the harmonic mean is used to average hydraulic conductivity values for flow that is perpendicular to layers e g geologic or soil while flow parallel to layers uses the arithmetic mean this apparent difference in averaging is explained by the fact that hydrology uses conductivity which is the inverse of resistivity in population genetics the harmonic mean is used when calculating the effects of fluctuations in generation size on the effective breeding population this is to take into account the fact that a very small generation is effectively like a bottleneck and means that a very small number of individuals are contributing disproportionately to the gene pool which can result in higher levels of inbreeding when considering fuel economy in automobiles two measures are commonly used miles per gallon mpg and litres per 100 160 km as the dimensions of these quantities are the inverse of each other one is distance per volume the other volume per distance when taking the mean value of the fuel economy of a range of cars one measure will produce the harmonic mean of the other i e converting the mean value of fuel economy expressed in litres per 100 160 km to miles per gallon will produce the harmonic mean of the fuel economy expressed in miles per gallon edit finance the harmonic mean is the preferable method for averaging multiples such as the price earning ratio in which price is in the numerator if these ratios are averaged using an arithmetic mean a common error high data points are given greater weights than low data points the harmonic mean on the other hand gives equal weight to each data point 8 edit statistics for a random sample the harmonic mean is calculated as above both the mean and the variance may be infinite if it includes at least one term of the form 1 0 edit theoretical value the variance of the harmonic mean is 9 where m is the arithmetic mean of the reciprocals x are the variates n is the population size and e is the expectation operator asymptotically e 1 x is distributed normally the mean of the sample m is also distributed normally with variance s 2 edit delta method assuming that the variance is not infinite and that the central limit theorem applies to the sample then using the delta method the variance is where h is the harmonic mean m is the arithmetic mean of the reciprocals s 2 is the variance of the reciprocals of the data and n is the number of data points in the sample edit jackknife method a jackknife method of estimating the variance is possible if the mean is known 10 this method is the usual delete 1 rather than the delete m version this method first requires the computation of the mean of the sample m where x are the sample values a series of value w i is then computed where the mean h of the w i is then taken the variance of the mean is significance testing and confidence intervals for the mean can then be estimated with the t test edit size biased sampling assume a random variate has a distribution f x assume also that the likelihood of a variate being chosen is proportional to its value this is known as length based or size biased sampling let be the mean of the population then the probability density function f x of the size biased population is the expectation of this length biased distribution e x is 9 where 2 is the variance the expectation of the harmonic mean is the same as the non length biased version e x the problem of length biased sampling arises in a number of areas including textile manufacture 11 pedigree analysis 12 and survival analysis 13 akman et al have developed a test for the detection of length based bias in samples 14 edit shifted variables if x is a positive random variable and q gt 0 then for all gt 0 15 edit moments assuming that x and e x are gt 0 then 15 this follows from jensen s inequality gurland has shown that 16 for a distribution that takes only positive values for any n gt 0 under some conditions 17 where means approximately edit lognormal distribution the harmonic mean h of a lognormal distribution is 18 where is the arithmetic mean and 2 is the variance of the distribution the harmonic and arithmetic means are related where c v is the coefficient of variation the geometric g arithmetic and harmonic means are related 19 edit sampling properties assuming that the variates x are drawn from a lognormal distribution there are several possible estimators for h where of these h 3 is probably the best estimator for samples of 25 or more 20 edit bias and variance estimators a first order approximation to the bias and variance of h 1 are 21 where c v is the coefficient of variation similarly a first order approximation to the bias and variance of h 3 are 21 it has been found in numerical experiments that h 3 is generally a superior estimator of the harmonic mean than h 1 21 h 2 produces estimates that are largely similar to h 1 edit pareto distribution the harmonic mean of a type 1 pareto distribution is 22 where k is the scale parameter and is the shape parameter edit beta distribution harmonic mean for beta distribution for 0 lt lt 5 and 0 lt lt 5 mean harmonicmean for beta distribution versus alpha and beta from 0 to 2 harmonic means for beta distribution purple h x yellow h 1 x smaller values alpha and beta in front harmonic means for beta distribution purple h x yellow h 1 x larger values alpha and beta in front the harmonic mean of a beta distribution with shape parameters and is the harmonic mean with lt 1 is undefined because its defining expression is not bounded in 0 1 letting showing that for the harmonic mean ranges from 0 for 1 to 1 2 for the following are the limits with one parameter finite non zero and the other parameter approaching these limits with the geometric mean the harmonic mean may be useful in maximum likelihood estimation in the four parameter case a second harmonic mean h 1 x also exists for this distribution this harmonic mean with lt 1 is undefined because its defining expression is not bounded in 0 1 letting in the above expression showing that for the harmonic mean ranges from 0 for 1 to 1 2 for the following are the limits with one parameter finite non zero and the other approaching these limits although both harmonic means are asymmetric when the two means are equal edit notes the environmental protection agency recommend the use of the harmonic mean in setting maximum toxin levels in water 23 in geophysical reservoir engineering studies the harmonic mean is widely used 24 the f1 score is the harmonic mean of precision and recall in sabermetrics the power speed number of a player is the harmonic mean of his home run and stolen base totals edit see also statistics portal mathematics portal contraharmonic mean generalized mean harmonic number rate mathematics weighted mean edit references mitchell dw 2004 more on spreads and non arithmetic means the mathematical gazette 88 142 144 taneja ij 2012 inequalities having seven means and proportionality relations arxiv 1203 2288v1 math ho 8 mar 2012 mercer a mcd 2000 bounds for a g a h g h and a family of inequalities of ky fan s type using a general method j math anal appl 243 163 173 sharma r 2008 some more inequalities for arithemtic mean harmonic mean and variance j math inequal 2 1 109 114 posamentier alfred s and salkind charles t challenging problems in geometry second edition dover publ co 1996 p 172 voles roger integer solutions of mathematical gazette 83 july 1999 269 271 richinick jennifer the upside down pythagorean theorem mathematical gazette 92 july 2008 313 317 fairness opinions common errors and omissions the handbook of business valuation and intellectual property analysis mcgraw hill 2004 isbn 0 07 142967 0 a b zelen m 1972 length biased sampling and biomedical problems in biometric society meeting dallas texas lam fc 1985 estimate of variance for harmonic mean half lives j pharm sci 74 2 229 231 cox dr 1969 some sampling problems in technology in new developments in survey sampling u l johnson h smith eds new york wiley interscience davidov o zelen m 2001 referent sampling family history and relative risk the role of length biased sampling biostat 2 2 173 181 doi 10 1093 biostatistics 2 2 173 zelen m feinleib m 1969 on the theory of screening for chronic diseases boimetrika 56 601 614 akman o gamage j jannot j juliano s thurman a whitman d 2007 a simple test for detection of length biased sampling j biostats 1 2 189 195 a b chuen teck see chen j 2008 convex functions of random variables j inequal pure appl math 9 3 art 80 gurland j 1967 an inequality satisfied by the expectation of the reciprocal of a random variable the american statistician 21 2 24 sung sh 2010 on inverse moments for a class of nonnegative random variables j inequal applic doi 10 1155 2010 823767 aitchison j brown jac 1969 the lognormal distribution with special reference to its uses in economics cambridge university press new york rossman la 1990 design stream flows based on harmonic means j hydr eng asce 116 7 946 950 stedinger jr 1980 fitting lognormal distributions to hydrologic data water resour res 16 3 481 490 a b c limbrunner jf vogel rm brown lc 2000 estimation of harmonic mean of a lognormal variable j hydrol eng 5 1 59 66 1 johnson nl kotz s balakrishnan n 1994 continuous univariate distributions vol 1 wiley series in probability and statistics epa 1991 technical support document for water quality based toxics control epa 505 2 90 001 office of water muskat m 1937 the flow of homogeneous fluids through porous media mcgraw hill new york edit external links weisstein eric w harmonic mean from mathworld averages arithmetic and harmonic means at cut the knot use of the harmonic mean in political science 2 v t e statistics 160 descriptive statistics continuous data location mean arithmetic geometric harmonic median mode dispersion range standard deviation coefficient of variation percentile interquartile range shape variance skewness kurtosis moments l moments count data index of dispersion summary tables grouped data frequency distribution contingency table dependence pearson product moment correlation rank correlation spearman s rho kendall s tau partial correlation scatter plot statistical graphics bar chart biplot box plot control chart correlogram forest plot histogram q q plot run chart scatter plot stemplot radar chart 160 data collection designing studies effect size standard error statistical power sample size determination survey methodology sampling stratified sampling opinion poll questionnaire controlled experiment design of experiments randomized experiment random assignment replication blocking factorial experiment optimal design uncontrolled studies natural experiment quasi experiment observational study 160 statistical inference statistical theory sampling distribution sufficient statistic meta analysis bayesian inference bayesian probability prior posterior credible interval bayes factor bayesian estimator maximum posterior estimator frequentist inference confidence interval hypothesis testing likelihood ratio specific tests z test normal student s t test f test chi squared test wald test mann whitney u shapiro wilk signed rank kolmogorov smirnov test general estimation bias robustness efficiency maximum likelihood method of moments minimum distance density estimation 160 correlation and regression analysis correlation pearson product moment correlation partial correlation confounding variable coefficient of determination regression analysis errors and residuals regression model validation mixed effects models simultaneous equations models linear regression simple linear regression ordinary least squares general linear model bayesian regression non standard predictors nonlinear regression nonparametric semiparametric isotonic robust generalized linear model exponential families logistic bernoulli binomial poisson partition of variance analysis of variance anova analysis of covariance multivariate anova degrees of freedom 160 categorical multivariate time series or survival analysis categorical data cohen s kappa contingency table graphical model log linear model mcnemar s test multivariate statistics multivariate regression principal components factor analysis cluster analysis classification copulas time series analysis general decomposition trend stationarity seasonal adjustment time domain acf pacf xcf arma model arima model vector autoregression frequency domain spectral density estimation survival analysis survival function kaplan meier logrank test failure rate proportional hazards models accelerated failure time model 160 applications biostatistics bioinformatics biometrics clinical trials amp studies epidemiology medical statistics engineering statistics chemometrics methods engineering probabilistic design process amp quality control reliability system identification social statistics actuarial science census crime statistics demography econometrics national accounts official statistics population psychometrics spatial statistics cartography environmental statistics geographic information system geostatistics kriging category portal outline index 